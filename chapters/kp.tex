\chapter*{Finite-Genus Solutions to the Kadomtsev-Petviashvili Equation}

Chapter \ref{ch:intro} hinted at a connection between Riemann surfaces and
periodic solutions to the Kadomtsev-Petviashvili equation
\begin{equation} \label{eqn:kp}
  \partial_y [XXX].
\end{equation}
The so-called ``finite-genus solutions'' are those of the form
\begin{equation} \label{eqn:finite-genus}
  u(x,y,t) = c + \partial_x^2 \log
  \theta\big(
  Ux + Vy + Wz - \Abel(P_\infty,\DivD) - \RCV(P_\infty), \Omega
  \big).
\end{equation}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Vectors $U$, $V$, and $W$}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\begin{theorem}[Stokes' Theorem] \label{thm:stokes}
  For any differential $\omega$ on a domain $D$ with piecewise smooth boundary
  $\partial D$,
  \begin{equation}
    \iint_D \dd \omega = \oint_{\partial D} \omega.
  \end{equation}
\end{theorem}
Immediately, we obtain two useful corollaries.
\begin{corollary} \label{cor:differential-hom-paths}
  A differential $\omega$ is closed if and only if for any two homologous paths
  $\gamma, \tilde{\gamma} \subset X$,
  \[
  \int_\gamma \omega = \int_{\tilde{\gamma}} \omega.
  \]
\end{corollary}
\begin{proof}
  Without loss of generality, we can assume that $\gamma(0) =
  \tilde{\gamma}(0)$ and $\gamma(1) = \tilde{\gamma}(1)$ and that the region
  $D$ with boundary $\partial D = \gamma - \tilde{\gamma}$ is simply
  connected. By Stokes' theorem,
  \[
  \iint_D \dd \omega
  =
  \oint_{\partial D} \omega
  =
  \int_\gamma \omega - \int_{\tilde{\gamma}} \omega.
  \]
  If $\omega$ is closed then $\dd \omega = 0$ and thus $\int_\gamma \omega =
  \int_{\tilde{\gamma}} \omega$. Conversely, if $\iint_D \dd \omega = 0$ then
    it must be the case the $\dd \omega = 0$.
\end{proof}

\begin{theorem} \label{thm:bilinear-relations}
  Let $\omega$ and $\omega'$ be closed differentials and let $A_j,B_j$ and
  $A_j',B_j'$ be their $a$- and $b$-periods, respectively. Let
  \[
  f(P) = \int_{P_0}^P \omega.
  \]
  Then
  \begin{equation} \label{eqn:closed-differential-periods}
    \iint_X \omega \wedge \omega'
    =
    \oint_{\partial \tilde{X}} f \omega'
    =
    \sum_{j=1}^g A_jB_j' - A_j'B_j
  \end{equation}
  where $\partial \tilde{X}$ is the boundary of the cut surface $\tilde{X}$
  oriented in the positive direction.
\end{theorem}
\begin{proof}
  By Stokes' theorem, $\iint_X \omega \wedge \omega' = \oint_{\partial
    \tilde{X}} f \omega'$. Also, writing the cut surface as
  \[
  \partial \tilde{X}
  =
  a_1 + b_1 + {a_1}^{-1} + {b_1}^{-1}
  + \cdots +
  a_g + b_g + {a_g}^{-1} + {b_g}^{-1}
  \]
  we have
  \begin{equation}
    \oint_{\partial \tilde{X}} f \omega'
    =
    \sum_{j=1}^g \left(
    \int_{a_j} + \int_{{a_j}^{-1}}
    \right) f \omega'
    +
    \sum_{j=1}^g \left(
    \int_{b_j} + \int_{{b_j}^{-1}}
    \right) f \omega'.
  \end{equation}

  \begin{figure}
    \centering
    \begin{tikzpicture}
      \input{images/tikz_cutsurface_section}
    \end{tikzpicture}
    \caption{A part of the boundary of the cut surface $\tilde{X}$.}
  \end{figure}

  Let us examine the pairs of integrals $\int_{a_j} + \int_{{a_j}^{-1}}$ and
  $\int_{a_j} + \int_{{a_j}^{-1}}$. The curves $a_j$ and ${a_j}^{-1}$ are
  identical on $X$ but have opposite orientation on the boundary $\partial
  \tilde{X}$. Let $P_j, P_j'$ be points lying on $a_j,a^{-1}_j$ repectively
  that coincide on $X$. Then,
  \begin{equation} \label{eqn:bilinear-coincide}
    \omega'(P_j) = \omega'(P_j')
    \qquad \text{and} \qquad
    f(P_j) - f(P_j')
    =
    \int_{P_0}^{P_j} \omega - \int_{P_0}^{P_j'} \omega
    =
    \int_{P_j'}^{P_j} \omega.
  \end{equation}
  The path from $P_j'$ to $P_j$ is homeomorphic to the reverse of the path
  $b_j$. Therefore, $f(P_j) - f(P_j') = -B_j$ for all such pairs $P_j,P_j'$
  along their respective paths and we can write
  \begin{equation}
    \int_{a_j} f \omega' + \int_{{a_j}^{-1}} f \omega'
    =
    \int_{a_j} f \omega' + \int_{{a_j}^{-1}} (f + B_j) \omega'
    =
    \int_{a_j} f \omega' - \int_{a_j} (f + B_j) \omega'
    =
    (-B_j) \oint_{a_j} \omega'.
  \end{equation}
  By a similar argument, we have
  \begin{equation}
    \int_{b_j} f \omega' + \int_{{b_j}^{-1}} f \omega'
    =
    A_j \oint_{b_j} \omega'.
  \end{equation}
\end{proof}

\begin{lemma} \label{lem:second-kind-b-periods}
  Let $\secondkind{Q}{n}$ be an Abelian differential of the second kind with
  pole of order $n+1$ at a place $Q \in X$. Then for all $i=1,\ldots, g$ and $n
  > 0$,
  \begin{equation}
  \ldots
  \end{equation}
  where $\tilde{\omega}_1, \ldots, \tilde{\omega}_g$ are basis holomorphic
  differentials and $\tilde{\omega}_i = f_i(t)dt$ in a neighborhood of $Q$. If
  $\omega_1, \ldots, \omega_g$ are normalized then the above simplifies to
  \begin{equation}
  \oint_{b_i} \secondkind{Q}{n} = \frac{2 \pi i}{n!} \frac{\dd^{n-1} f_i
    (Q)}{\dt^{n-1}}.
  \end{equation}
\end{lemma}
\begin{proof}
  Consider the differential $\tilde{A}_i \secondkind{Q}{n}$ where
  $\tilde{A}_i(P) = \int_{P_0}^P \omega_i$ is the $i$th component of the
  non-normalized Abel map \ref{def:abelmap}. Following the proof of
  \ref{thm:bilinear-relations}, consider the integral of $A_i
  \secondkind{Q}{n}$ along the cut surface $\partial \tilde{X}$ and set $\omega
  = \omega_i$ and $\omega' = \secondkind{Q}{n}$. We have
  \begin{equation}
    \oint_{\partial \tilde{X}} A_i \secondkind{Q}{n}
    =
    \sum_{j=1}^g (-B_{ij}) \oint_{a_j} \secondkind{Q}{n}
    +
    \sum_{j=1}^g A_{ij} \oint_{b_j} \secondkind{Q}{n}.
  \end{equation}
  Since $\oint_{a_j} \secondkind{Q}{n} = 0$ for $j=1,\ldots,g$ Equation
\end{proof}


\begin{figure}
  \centering
  \begin{tikzpicture}[scale=0.8]
    \input{images/tikz_cutsurface}

    % the poles and integrating paths
    \draw[edge,dashed] (1,4) circle (3);
    \path (2,3.3) node{$P_0$}
    -- (0,4.3) node {$Q$};
    \path (2,4) node {$\bullet$}
    -- (0,5) node {$\bullet$};

    \begin{scope}[xshift=4.5in]
      \input{images/tikz_cutsurface}
      % the poles and integrating paths
      \draw[edge,dashed] (2,4) circle (0.4);
      \draw[edge,dashed] (0,5) circle (0.4);
      \path (2,3.3) node{$P_0$}
      -- (0,4.3) node {$Q$};
      \path (2,4) node {$\bullet$}
      -- (0,5) node {$\bullet$};
    \end{scope}
  \end{tikzpicture}
  \caption{Integrating the meromorphic differential $A_i \secondkind{Q}{n}$
    around the cut surface $\partial \tilde{X}$. The path of integration can be
    deformed to two smaller paths about the places $P_0,Q \in X$.}
\end{figure}


\section{Evaluation of KP Formula}

\begin{equation*}
  u(x,y,t) = c + \partial_x^2 \log
  \theta\big(
  Ux + Vy + Wz - \Abel(P_\infty,\DivD) - \RCV(P_\infty), \Omega
  \big)
\end{equation*}
To make the following expressions involving the gradient and Hessian of the
Riemann theta function more easily readable we introduce some notation. Let $z
= (z_1, \ldots, z_g) \in \CC$. We suppress the dependence of $\theta$ on the
Riemann matrix $\Omega$ by defining $\theta(z) := \theta(z,\Omega)$. Define,
\begin{equation} \label{eqn:theta-deriv1-compact}
  \theta_i(z)
  :=
  \partial_{z_i} \theta \big( (z_1, \ldots, z_g) \big)
\end{equation}
and
\begin{equation} \label{eqn:theta-deriv2-compact}
  \theta_{ij}(z)
  :=
  \partial_{z_i} \partial_{z_j} \theta \big( (z_1, \ldots, z_g) \big).
\end{equation}
The gradient and Hessian of $\theta$ at $z$ is given by
\begin{equation} \label{eqn:theta-grad-compact}
  \nabla \theta(z)
  :=
  \big( \theta_1(z), \ldots, \theta_g(z) \big)
\end{equation}
and
\begin{equation} \label{eqn:theta-hess-compact}
  H(\theta)(z)
  :=
  \begin{pmatrix}
    \theta_{11}(z) & \theta_{12}(z) & \cdots & \theta_{1g}(z) \\
    \theta_{21}(z) & \theta_{22}(z) & \cdots & \theta_{2g}(z) \\
    \vdots         & \vdots         & \ddots & \vdots         \\
    \theta_{g1}(z) & \theta_{g2}(z) & \cdots & \theta_{gg}(z)
  \end{pmatrix},
\end{equation}
respectively.

Let $z(x) = Ux + Vy + Wz - \Abel(P_\infty,\DivD) - \RCV(P_\infty)$. Then
\begin{align}
  \partial_x^2 \log \theta(z(x))
  &=
  \partial_x \left(
  \frac{
    \nabla \theta\big(z(x)\big) \cdot U
  }{
    \theta\big(z(x)\big)
  }
  \right) \\
  &=
  \frac{
    \theta\big(z(x)\big) H(\theta)\big(z(x)\big)U \cdot U
    - \Big( \nabla \theta\big(z(x)\big) \cdot U \Big)^2
  }{
    \theta\big(z(x)\big)^2.
  }
\end{align}
